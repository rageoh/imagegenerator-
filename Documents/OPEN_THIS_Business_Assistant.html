<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Business Shopping Assistant</title>
    <style>
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    line-height: 1.5;
    color: #1f2937;
    background: #f3f4f6;
}

.container {
    max-width: 900px;
    margin: 0 auto;
    padding: 24px;
}

header {
    margin-bottom: 20px;
}

header h1 {
    font-size: 1.75rem;
    margin-bottom: 6px;
}

header p {
    color: #4b5563;
}

main {
    display: grid;
    gap: 16px;
}

.card {
    background: #fff;
    border: 1px solid #e5e7eb;
    border-radius: 12px;
    padding: 16px;
}

.form-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
}

.field {
    display: grid;
    gap: 6px;
    margin-top: 8px;
}

label {
    font-weight: 600;
}

input[type="text"], textarea {
    border: 1px solid #d1d5db;
    border-radius: 8px;
    padding: 10px 12px;
    font-size: 16px;
    background: #fff;
}

textarea {
    min-height: 110px;
    resize: vertical;
}

small {
    color: #6b7280;
}

.actions {
    display: flex;
    gap: 8px;
    margin-top: 12px;
}

button {
    appearance: none;
    border: 1px solid #2563eb;
    background: #2563eb;
    color: #fff;
    padding: 10px 14px;
    border-radius: 8px;
    cursor: pointer;
}

button.secondary {
    background: #fff;
    color: #111827;
    border-color: #d1d5db;
}

button:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

.output {
    white-space: pre-wrap;
    word-break: break-word;
    min-height: 120px;
}

.example-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin-top: 8px;
}

.example-title {
    font-weight: 600;
    margin-bottom: 6px;
}

.example-block {
    border: 1px solid #e5e7eb;
    padding: 12px;
    border-radius: 8px;
    background: #f9fafb;
}

footer {
    margin-top: 16px;
    color: #6b7280;
}

@media (max-width: 720px) {
    .form-grid, .example-grid {
        grid-template-columns: 1fr;
    }
}
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Smart Business Shopping Assistant</h1>
            <p>Enter your business details; get a weekly shopping list with ~10% buffer.</p>
        </header>

        <main>
            <section class="card">
                <div class="form-grid">
                    <div class="field">
                        <label for="businessType">Business type</label>
                        <input id="businessType" type="text" placeholder="e.g., Restaurant" />
                    </div>
                    <div class="field">
                        <label for="weeklyRevenue">Weekly revenue</label>
                        <input id="weeklyRevenue" type="text" placeholder="$3,000" />
                    </div>
                </div>

                <div class="field">
                    <label for="dailySales">Average daily sales</label>
                    <textarea id="dailySales" rows="5" placeholder="One item per line, e.g.\n200 burgers, 100 buns, 50 sodas"></textarea>
                    <small>Use plain numbers and item names; commas or "x" are accepted. Examples: "200 burgers", "100 buns", "50 sodas"</small>
                </div>

                <div class="actions">
                    <button id="generateBtn">Generate shopping list</button>
                    <button id="copyBtn" class="secondary">Copy list</button>
                </div>
            </section>

            <section class="card">
                <h2>Shopping list (weekly +10% buffer)</h2>
                <pre id="output" class="output" aria-live="polite"></pre>
            </section>

            <section class="card example">
                <details>
                    <summary>Example</summary>
                    <div class="example-grid">
                        <div>
                            <div class="example-title">Input</div>
                            <pre class="example-block">Business type: Restaurant
Weekly revenue: $3,000
Average daily sales: 200 burgers, 100 buns, 50 sodas</pre>
                        </div>
                        <div>
                            <div class="example-title">Output format</div>
                            <pre class="example-block">- Item: Quantity
- Item: Quantity
- Item: Quantity</pre>
                        </div>
                    </div>
                </details>
            </section>
        </main>

        <footer>
            <small>No extra text will be added to the output — only the list.</small>
        </footer>
    </div>

    <script>
function parseCurrencyToNumber(text) {
    if (!text) return 0;
    const cleaned = String(text)
        .replace(/[^0-9.,-]/g, '')
        .replace(/,(?=\d{3}(\D|$))/g, '')
        .replace(/,/g, '.');
    const value = parseFloat(cleaned);
    return Number.isFinite(value) ? value : 0;
}

function parseDailySalesLines(raw) {
    const lines = String(raw || '')
        .split(/\n|,\s*(?=\d+\s*\w)/g)
        .map(s => s.trim())
        .filter(Boolean);

    const items = [];
    for (const line of lines) {
        const match = line.match(/^(\d+(?:[.,]\d+)?)\s*(?:x|\*)?\s*[-–—:]?\s*(.+)$/i);
        if (match) {
            const qty = parseFloat(match[1].replace(',', '.'));
            const name = match[2].trim();
            if (Number.isFinite(qty) && name) {
                items.push({ name, dailyQty: qty });
            }
            continue;
        }
        const alt = line.match(/^(.+?)\s*[:–—-]\s*(\d+(?:[.,]\d+)?)$/);
        if (alt) {
            const name = alt[1].trim();
            const qty = parseFloat(alt[2].replace(',', '.'));
            if (Number.isFinite(qty) && name) {
                items.push({ name, dailyQty: qty });
            }
        }
    }
    return items;
}

function computeWeeklyWithBuffer(items, bufferRate = 0.10) {
    return items.map(item => {
        const weekly = item.dailyQty * 7;
        const withBuffer = Math.ceil(weekly * (1 + bufferRate));
        return { name: item.name, quantity: withBuffer };
    });
}

function formatListLines(items) {
    return items.map(i => `- ${i.name}: ${i.quantity}`).join('\n');
}

function generateList() {
    const businessType = document.getElementById('businessType').value.trim();
    const weeklyRevenue = document.getElementById('weeklyRevenue').value.trim();
    const dailySales = document.getElementById('dailySales').value.trim();

    const _revenue = parseCurrencyToNumber(weeklyRevenue);
    const parsedDaily = parseDailySalesLines(dailySales);

    const weekly = computeWeeklyWithBuffer(parsedDaily, 0.10);
    const lines = formatListLines(weekly);

    const output = document.getElementById('output');
    output.textContent = lines;
}

function copyOutput() {
    const output = document.getElementById('output').textContent || '';
    if (!output) return;
    navigator.clipboard.writeText(output).catch(() => {
        const ta = document.createElement('textarea');
        ta.value = output;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand('copy');
        document.body.removeChild(ta);
    });
}

document.addEventListener('DOMContentLoaded', () => {
    document.getElementById('generateBtn').addEventListener('click', generateList);
    document.getElementById('copyBtn').addEventListener('click', copyOutput);

    document.getElementById('dailySales').addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) {
            generateList();
        }
    });

    if (!location.search.includes('noexample')) {
        document.getElementById('businessType').value = 'Restaurant';
        document.getElementById('weeklyRevenue').value = '$3,000';
        document.getElementById('dailySales').value = '200 burgers, 100 buns, 50 sodas';
    }
});
    </script>
</body>
</html>

